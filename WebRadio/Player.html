<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
  <link rel="stylesheet" href="player.css">
</head>
<body>
  <div class="radio-player">
    <audio class="visually-hidden" id="stream"></audio>
    <div class="player-controls">
      <div class="volume-and-title">
        <span class="current-tuning-label">Current Station:</span>
        <span class="current-tuning" id="currentStation">Some Radio Station</span>
      </div>
    </div>
    <div class="voice-command-prompts">
      <span>Say "Volume Up" or "Volume Down" to adjust the volume.</span>
      <span>Say "Turn On" or "Turn Off" to toggle the audio.</span>
      <span>Say "Play [Station Name]" to switch to a different station.</span>
    </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const audioElement = document.getElementById('stream');
      const volumeControl = document.querySelector('.volume');
      const currentStationElement = document.getElementById('currentStation');
      let isPlaying = false;
      let stationUrl = 'https://media-ice.musicradio.com/bigTop40'; // Set your default radio station URL

      // Set up the volume control
      volumeControl.addEventListener('input', function() {
        const volumeValue = this.value;
        audioElement.volume = volumeValue;
      });

      // Access the user's microphone
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then(function(stream) {
          audioElement.srcObject = stream;

          // Voice recognition for volume control, on/off, and station switching
          const recognition = new webkitSpeechRecognition();
          recognition.continuous = true;
          recognition.lang = 'en-US';

          recognition.onresult = function(event) {
            const last = event.results.length - 1;
            const command = event.results[last][0].transcript.toLowerCase().trim();

            // Adjust volume based on voice command
            if (command.includes('volume up')) {
              audioElement.volume = Math.min(1, audioElement.volume + 0.1);
            } else if (command.includes('volume down')) {
              audioElement.volume = Math.max(0, audioElement.volume - 0.1);
            }

            // Toggle on/off based on voice command
            if (command.includes('turn on')) {
              if (!isPlaying) {
                audioElement.play();
                isPlaying = true;
              }
            } else if (command.includes('turn off')) {
              if (isPlaying) {
                audioElement.pause();
                isPlaying = false;
              }
            }

            // Switch station based on voice command
            if (command.includes('play')) {
              const stationName = command.replace('play', '').trim();
              // Add logic to map stationName to the corresponding URL
              // For example, you can have a predefined mapping or use an API to fetch the URL
              // For now, setting it to a default URL
              stationUrl = 'https://media-ice.musicraadio.com/' + stationName;
              currentStationElement.textContent = stationName;
              // Stop the current playback and load the new station
              audioElement.pause();
              audioElement.src = stationUrl;
              audioElement.load();
              if (isPlaying) {
                audioElement.play();
              }
            }
          };

          recognition.start();
        })
        .catch(function(err) {
          console.error('Error accessing the microphone:', err);
        });
    });
  </script>
</body>
</html>